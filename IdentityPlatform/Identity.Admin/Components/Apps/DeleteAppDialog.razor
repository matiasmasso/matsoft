@inject AppsService Apps

<SharedModal Visible="Visible"
            Title="Delete App"
            DialogSize="modal-sm"
            OnClose="HandleClose"
            Body="@BodyContent"
            Footer="@FooterContent" />

@code {
    [Parameter] public bool Visible { get; set; }
    [Parameter] public AppDto App { get; set; } = default!;
    [Parameter] public EventCallback<Guid> OnDeleted { get; set; }
    [Parameter] public EventCallback OnCancel { get; set; }

    private bool isSubmitting = false;

    private RenderFragment BodyContent => @<div>
        <p>Are you sure you want to delete <strong>@App.Name</strong>?</p>
    </div>;

    private RenderFragment FooterContent => @<div>
        <button class="btn btn-secondary" disabled="@isSubmitting" @onclick="Cancel">Cancel</button>
        <button class="btn btn-danger" disabled="@isSubmitting" @onclick="Submit">
            @(isSubmitting ? "Deleting..." : "Delete")
        </button>
    </div>;

    private async Task Submit()
    {
        isSubmitting = true;

        var ok = await Apps.DeleteAsync(App.Id);

        isSubmitting = false;

        if (ok)
            await OnDeleted.InvokeAsync(App.Id);
    }

    private async Task Cancel() => await OnCancel.InvokeAsync();
    private async Task HandleClose(bool _) => await OnCancel.InvokeAsync();
}