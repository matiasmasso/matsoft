@inject CultureService culture
@inject PgcCtasService pgcCtasService

<div class="Grid">
    <div class="ColHeaders">
        <div class="Nom">@culture.Localize("Account")</div>
        <div class="Num">@culture.Localize("Debit")</div>
        <div class="Num">@culture.Localize("Credit")</div>
        <div class="Num">@culture.Localize("DebitBalance")</div>
        <div class="Num">@culture.Localize("CreditBalance")</div>
    </div>

    <div class="Total">
        <div class="Nom">@culture.Localize("Total")</div>
        <div class="Num">@(Items?.Sum(x => x.Deb) == 0 ? "" : string.Format("{0:N2} €", Items?.Sum(x => x.Deb)))</div>
        <div class="Num">@(Items?.Sum(x => x.Hab) == 0 ? "" : string.Format("{0:N2} €", Items?.Sum(x => x.Hab)))</div>
        <div class="Num">@(Items?.Sum(x => x.SaldoDeutor) == 0 ? "" : string.Format("{0:N2} €", Items?.Sum(x => x.SaldoDeutor)))</div>
        <div class="Num">@(Items?.Sum(x => x.SaldoCreditor) == 0 ? "" : string.Format("{0:N2} €", Items?.Sum(x => x.SaldoCreditor)))</div>
    </div>

    @foreach (var item in Items ?? new())
    {
        <a class="Item" href="#" @onclick="@(()=>ItemClick(item))" @onclick:preventDefault>
            <div class="Nom">@item.Label</div>
            <div class="Num">@(item.Deb == 0 ? "" : string.Format("{0:N2} €", item.Deb))</div>
            <div class="Num">@(item.Hab == 0 ? "" : string.Format("{0:N2} €", item.Hab))</div>
            <div class="Num">@(item.SaldoDeutor == 0 ? "" : string.Format("{0:N2} €", item.SaldoDeutor))</div>
            <div class="Num">@(item.SaldoCreditor == 0 ? "" : string.Format("{0:N2} €", item.SaldoCreditor))</div>
        </a>
    }
</div>

@code {
    [Parameter] public List<PgcCtaSdosService.Item>? Items { get; set; }
    [Parameter] public EventCallback<PgcCtaModel> ItemSelected { get; set; }


    async Task ItemClick(PgcCtaSdosService.Item item)
    {
        await ItemSelected.InvokeAsync((PgcCtaModel)item.Tag);
    }


}
